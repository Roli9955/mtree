DROP EXTENSION IF EXISTS mtree_gist CASCADE;
CREATE EXTENSION mtree_gist;

DROP TABLE IF EXISTS INT8_2000 CASCADE;
CREATE TABLE INT8_2000 (
  id  INTEGER,
  num mtree_int8
);
COPY INT8_2000(id, num) FROM '/home/postgres/2000_int.csv' DELIMITER ',' CSV HEADER;

DROP INDEX IF EXISTS INT8_2000_GiST_Mtree CASCADE;
CREATE INDEX INT8_2000_GiST_Mtree ON INT8_2000 USING GiST (num mtree_int8_opclass);

SET enable_seqscan = OFF;

SELECT id, num, (num <-> '0') AS dst FROM INT8_2000 ORDER BY (num <-> '0');

EXPLAIN ANALYZE SELECT * FROM INT8_2000 WHERE num #<# '0';
SELECT * FROM INT8_2000 WHERE num #<# '0';
