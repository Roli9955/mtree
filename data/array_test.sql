DROP EXTENSION IF EXISTS mtree_gist CASCADE;
CREATE EXTENSION mtree_gist;

DROP TABLE IF EXISTS INT8_ARRAY_TEST CASCADE;
CREATE TABLE INT8_ARRAY_TEST (
  id  INTEGER,
  num mtree_int8_array
);
COPY INT8_ARRAY_TEST(id, num) FROM '/home/postgres/array_test.csv' DELIMITER ';' CSV HEADER;

DROP INDEX IF EXISTS INT8_ARRAY_TEST_GiST_Mtree CASCADE;
CREATE INDEX INT8_ARRAY_TEST_GiST_Mtree ON INT8_ARRAY_TEST USING GiST (num mtree_int8_array_opclass);

SET enable_seqscan = OFF;

SELECT * FROM INT8_ARRAY_TEST;

SELECT id, num, (num <-> '0,0,0,0,0') AS dst FROM INT8_ARRAY_TEST ORDER BY (num <-> '0,0,0,0,0');

EXPLAIN ANALYZE SELECT * FROM INT8_ARRAY_TEST WHERE num #<# '0,0,0,0,0';
SELECT * FROM INT8_ARRAY_TEST WHERE num #<# '0,0,0,0,0';
